package h3;

import java.io.BufferedReader;
import java.io.File;
import java.io.FileReader;
import java.sql.Connection;
import java.sql.Date;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.SQLException;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;
public class fileToDb {
	static String url ="jdbc:mysql:/ip:port/db?characterEncoding=utf8&amp;useUnicode=true";
	static String id = "kjh";
	static String pw = "1234";
	static String driver = "com.mysql.jdbc.Driver";
	static int MAX_BUF_BYTE = 1024000;
	protected Connection conn;
			
	public static void LoadDataInfileExcute() throws Exception{
		Connection conn = null;
		PreparedStatement stmt = null;
		Class.forName(driver);
		List<Map<String,Object>> list = new ArrayList<Map<String,Object>>();
		String[] row = null; //분할
		
		int idx = -1;
		try {
			conn = DriverManager.getConnection(url, id, pw);
			
			File f = new File("C:/test1.txt");
			FileReader filereader = new FileReader(f);
			BufferedReader br= new BufferedReader(filereader);
			String line = "";
			for(int i=0; (line=br.readLine()) != null; i++) {
				HashMap<String,Object> map = new HashMap<String,Object>();
				row = line.split(",");
				for(String a : row) {
					++idx;
					map.put(String.valueOf(idx), a);	
				}
				list.add(map);
			}
			
			String query = "INSERT INTO subway values (?,?,?,?,?,?,?,?,?,?,?)";
			stmt = conn.prepareStatement(query);
			// 리스트 가져오기
			int cnt = 1;
	        for(Map<String, Object> mapVal : list){
	        	for(Map.Entry<String, Object> col : mapVal.entrySet()) {
	        		if(cnt%11==0) {
	        			stmt.setString(cnt,col.getValue().toString());
	        			System.out.println(cnt);
	        			stmt.executeUpdate();
	        			cnt = 1;
	        		}else {
	        			System.out.println(cnt);
	        			stmt.setString(cnt,col.getValue().toString());
	        			cnt++;
	        		}
	        	}
	        }		
			br.close();
			filereader.close();
		}catch(Exception e) {	
			System.out.println("e: "+e);
		}finally {
			conn.close();
			stmt.close();
		}
	}
	
	public static void main(String[] args) {
		try {
			LoadDataInfileExcute();
		}catch(Exception e) {
			System.out.println("me: "+e);
		}
	}
}


----
mysql-connector-java-5.1.31.jar
