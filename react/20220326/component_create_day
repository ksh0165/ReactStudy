import usefetch from "../hooks/useFetch";
import React, {useState} from "react";
import { useNavigate } from 'react-router-dom';
import {IDay} from "./DayList";
export default function CreateDay(){
    const days : IDay[] = usefetch("http://localhost:3001/days");
    const navigate = useNavigate();
    const [isLoding, setIsLoding] = useState(false);

    function addDay(e : React.MouseEvent<HTMLButtonElement>){
        e.preventDefault();
        if(!isLoding){
            setIsLoding(true);
            fetch(`http://localhost:3001/days/`,{
                method:'POST',
                headers:{
                    'Content-Type':'application/json'
                },
                body:JSON.stringify({
                    day : days.length+1
                })
            })
            .then(res=>{
                if(res.ok){
                    alert("생성이 완료되었습니다.");
                    navigate("/");
                    setIsLoding(false);
                }
            })
        }
    }

    return (
    <div>
        <h3>현재 일수 : {days.length}일</h3>
        <button  style={{opacity: isLoding ? 0.3 : 1}} onClick={addDay}>{isLoding ? "Day 추가중..." : "Day 추가"}</button>
    </div>
    )
}
